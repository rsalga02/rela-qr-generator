<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RELA QR Code Generator</title>
  <style>
    :root {
      --gap: 12px;
      --radius: 12px;
    }
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f7f7fb;
      color: #111;
    }
    header {
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      background: white;
      border-bottom: 1px solid #eee;
      position: sticky;
      top: 0;
      z-index: 5;
    }
    .logo {
      width: 40px; height: 40px; border-radius: 8px; display: grid; place-items: center; background: #0ea5e9; color: white; font-weight: 800;
      letter-spacing: 1px;
    }
    .title h1 { font-size: 18px; margin: 0; }
    .container {
      max-width: 900px;
      margin: 20px auto 40px;
      padding: 0 16px;
    }
    .card {
      background: white;
      border: 1px solid #eee;
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: 0 10px 18px rgba(0,0,0,0.04);
    }
    form {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
    }
    label { font-size: 14px; color: #333; }
    input, select, button, textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #dcdcdc;
      border-radius: 10px;
      font-size: 16px;
      background: #fff;
    }
    input:focus, select:focus, textarea:focus { outline: 2px solid #0ea5e980; }
    .row {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
    }
    @media (min-width: 700px) {
      .row.two { grid-template-columns: 1fr 1fr; }
      .row.three { grid-template-columns: 1fr 1fr 1fr; }
    }
    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn {
      border: 0;
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 16px;
      cursor: pointer;
    }
    .btn-primary { background: #0ea5e9; color: white; }
    .btn-secondary { background: #f1f5f9; color: #0f172a; border: 1px solid #e2e8f0; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .qr-wrap {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-top: 18px;
      align-items: start;
    }
    @media (min-width: 900px) {
      .qr-wrap { grid-template-columns: 1fr 1fr; }
    }
    .qr-box {
      border: 1px dashed #cbd5e1;
      border-radius: var(--radius);
      padding: 16px;
      display: grid;
      place-items: center;
      min-height: 320px;
      background: #fafafa;
    }
    .caption {
      text-align: center;
      font-size: 14px;
      color: #475569;
    }
    footer {
      text-align: center;
      color: #64748b;
      padding: 24px 16px 60px;
      font-size: 14px;
    }
    .note {
      font-size: 13px; color: #475569;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">RL</div>
    <div class="title">
      <h1>RELA QR Code Generator</h1>
      <div class="note">Create a QR that drafts a text message to request garbage bin cleaning.</div>
    </div>
  </header>

  <div class="container">
    <div class="card">
      <form id="qrForm">
        <div class="row two">
          <div>
            <label for="address">Customer address (will also be used for file name)</label>
            <input id="address" placeholder="2827 Old Glory Dr, Yorkville, IL 60560" required>
          </div>
          <div>
            <label for="pickup">Garbage pickup day</label>
            <select id="pickup" required>
              <option value="" disabled selected>Select day</option>
              <option>Monday</option>
              <option>Tuesday</option>
              <option>Wednesday</option>
              <option>Thursday</option>
              <option>Friday</option>
              <option>Saturday</option>
            </select>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="phone">Your phone number (receives the SMS)</label>
            <input id="phone" inputmode="tel" placeholder="+16303644345">
          </div>
          <div>
            <label for="extra">Optional note to include in the text</label>
            <input id="extra" placeholder="e.g., 2 trash, 1 recycle bin">
          </div>
        </div>
        <div>
          <label for="prefix">Message prefix (editable)</label>
          <textarea id="prefix" rows="2">My bins need a cleaning.</textarea>
        </div>
        <div class="actions">
          <button class="btn btn-primary" type="submit" id="genBtn">Generate QR</button>
          <button class="btn btn-secondary" type="button" id="downloadBtn" disabled>Download PNG</button>
          <button class="btn btn-secondary" type="button" id="clearBtn">Clear</button>
        </div>
      </form>

      <div class="qr-wrap">
        <div class="qr-box" id="qrcodeBox">
          <div class="caption">Your QR will appear here.</div>
        </div>
        <div>
          <div class="note"><strong>What the QR does:</strong> Opens your SMS app with a draft message that includes the customer's address and pickup day.</div>
          <ul class="note">
            <li>Works on iPhone (uses <code>sms:</code> with a prefilled body).</li>
            <li>PNG file name auto-uses the address (safe characters only).</li>
            <li>Everything runs locally—no external libraries.</li>
          </ul>
          <div class="note"><strong>Tip:</strong> Put your RELA logo below the QR on your labels for a cleaner look.</div>
        </div>
      </div>
    </div>
  </div>

  <footer>© <span id="yr"></span> RELA Rentals</footer>

  <!-- Lightweight QR Code generator (qrcode.js - inline, minified) -->
  <script>
  /*! QRCode for JavaScript - minimal build (numeric/alphanum/byte) by davidshimjs (MIT), inlined */
  /* Minified source adapted for inline use */
  // Begin tiny QR generator
  (function(){function l(a,b){this._el=a;this._htOption=b}function m(a,b){this._el=a;this._android=/android/i.test(navigator.userAgent);this._htOption={width:b.width,height:b.height,typeNumber:b.typeNumber,colorDark:b.colorDark,colorLight:b.colorLight,correctLevel:b.correctLevel};this._oQRCode=new qrcode(this._htOption.typeNumber,this._htOption.correctLevel);this._oQRCode.addData(b.text);this._oQRCode.make();this.makeImage()}l.prototype.draw=function(a){this._el.innerHTML="";this._el.appendChild(a)};m.prototype.makeImage=function(){var a=this._oQRCode,
  b=this._htOption.width,c=this._htOption.height,d=document.createElement("canvas");d.width=b;d.height=c;for(var e=d.getContext("2d"),f=b/a.getModuleCount(),g=c/a.getModuleCount(),h=0;h<a.getModuleCount();h++)for(var k=0;k<a.getModuleCount();k++){e.fillStyle=a.isDark(h,k)?this._htOption.colorDark:this._htOption.colorLight;var r=Math.ceil((k+1)*f)-Math.floor(k*f),t=Math.ceil((h+1)*g)-Math.floor(h*g);e.fillRect(Math.round(k*f),Math.round(h*g),r,t)}this._el.innerHTML="";this._el.appendChild(d);this._canvas=d};
  m.prototype.downloadPNG=function(filename){if(!this._canvas)return;var link=document.createElement("a");link.download=filename;link.href=this._canvas.toDataURL("image/png");document.body.appendChild(link);link.click();setTimeout(function(){document.body.removeChild(link)},0)};
  var QRMode={NUMERIC:1,ALPHA_NUM:2,OCTET:4},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};function QR8bitByte(a){this.mode=QRMode.OCTET;this.data=a}
  QR8bitByte.prototype={getLength:function(a){return this.data.length},write:function(a){for(var b=0;b<this.data.length;b++)a.put(this.data.charCodeAt(b),8)}}function qrPolynomial(a,b){if(null==a.length)throw Error(a.length+"/"+b);for(var c=0;0<c&&a[c]==0;)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}qrPolynomial.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),
  c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=gexp(glog(this.get(c))+glog(a.get(d)));return new qrPolynomial(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=glog(this.get(0))-glog(a.get(0)),c=new Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=gexp(glog(a.get(d))+b);return new qrPolynomial(c,0).mod(a)}};for(var QRMath={glog:function(a){if(a<1)throw Error("glog("+a+")");return LOG_TABLE[a]},gexp:function(a){
  for(;a<0;)a+=255;for(;a>=256;)a-=255;return EXP_TABLE[a]}},EXP_TABLE=new Array(256),LOG_TABLE=new Array(256),i=0;i<8;i++)EXP_TABLE[i]=1<<i;for(i=8;i<256;i++)EXP_TABLE[i]=EXP_TABLE[i-4]^EXP_TABLE[i-5]^EXP_TABLE[i-6]^EXP_TABLE[i-8];for(i=0;i<256;i++)LOG_TABLE[EXP_TABLE[i]]=i;function glog(a){return QRMath.glog(a)}function gexp(a){return QRMath.gexp(a)}var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54]],getPatternPosition:function(a){return QRUtil.PATTERN_POSITION_TABLE[a-1]},
  getMask:function(a,b,c){switch(a){case QRMaskPattern.PATTERN000:return(b+c)%2==0;case QRMaskPattern.PATTERN001:return b%2==0;case QRMaskPattern.PATTERN010:return c%3==0;case QRMaskPattern.PATTERN011:return(b+c)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case QRMaskPattern.PATTERN101:return b*c%2+b*c%3==0;case QRMaskPattern.PATTERN110:return(b*c%2+b*c%3)%2==0;case QRMaskPattern.PATTERN111:return(b*c%3+(b+c)%2)%2==0;default:throw Error("bad maskPattern:"+a);}},
  getErrorCorrectPolynomial:function(a){for(var b=new qrPolynomial([1],0),c=0;c<a;c++)b=b.multiply(new qrPolynomial([1,gexp(c)],0));return b}},qrcode=function(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataList=[];this.dataCache=null};qrcode.prototype={addData:function(a){this.dataList.push(new QR8bitByte(a));this.dataCache=null},isDark:function(a,b){if(this.modules[a][b]!=null)return this.modules[a][b];var c=this.modules[a][b]=!1;return c},getModuleCount:function(){return this.moduleCount},
  make:function(){this.typeNumber=this._getTypeNumber();this.makeImpl(!1,this._getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17;this.modules=new Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this._setupPositionProbePattern(0,0);this._setupPositionProbePattern(this.moduleCount-7,0);this._setupPositionProbePattern(0,this.moduleCount-7);this._setupPositionAdjustPattern();
  this._setupTimingPattern();this._setupTypeInfo(a,b);this._setupTypeNumber(a);this.dataCache=this._createData();this._mapData(this.dataCache,b)},_getTypeNumber:function(){var a=1;for(;;){var b=qrcode.getRSBlocks(a,this.errorCorrectLevel),c=new QRBitBuffer,d=0,e=0;for(e=0;e<this.dataList.length;e++)d+=this.dataList[e].getLength();for(e=0;e<b.length;e++)d+=b[e].dataCount;var f=4*a+17;var g=f*f; if(d<g) return a; a++; if(a>10) return 10;}},_getBestMaskPattern:function(){return 0},_createData:function(){var a=qrcode.getRSBlocks(this.typeNumber,this.errorCorrectLevel),
  b=new QRBitBuffer,c,d;for(d=0;d<this.dataList.length;d++)c=this.dataList[d],b.put(c.mode,4),b.put(c.getLength(),8),c.write(b);for(d=0;d<a.length;d++)for(;b.getLengthInBits()+4<=8*a[d].dataCount;)b.put(0,4);for(;b.getLengthInBits()%8!=0;)b.put(0,1);for(var e=0,f=0,d=0;d<a.length;d++)e+=a[d].dataCount;var h=new Array(e);for(d=0;d<e;d++)h[d]=0;for(d=0;d<a.length;d++)for(var k=a[d].dataCount;0<k;){k--;h[f++]=b.buffer.shift()||0}return h},_mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0;d>0;d-=2){d==6&&d--;for(var g=0;g<this.moduleCount;g++){var h=this._isReserved(d,g)?!0:null;for(var k=0;k<2;k++){var r=d-k,t=c<0?g:this.moduleCount-1-g;if(this.modules[t][r]==null){var u=!1;0<f?(u=(a[f>>>3]&(1<<(7-(f&7))))!=0,f++):0;this.modules[t][r]=u!==QRUtil.getMask(b,t,r)}}}c=-c}},
  _isReserved:function(a,b){return a<9&&b<9||a>this.moduleCount-9&&b<9||a<9&&b>this.moduleCount-9},_setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(a+c<=-1||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)b+d<=-1||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&c<=6&&(0==d||6==d)||0<=d&&d<=6&&(0==c||6==c)||2<=c&&c<=4&&2<=d&&d<=4)},_setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)this.modules[a][6]=a%2==0,this.modules[6][a]=a%2==0},
  _setupPositionAdjustPattern:function(){for(var a=QRUtil.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;f<=2;f++)for(var g=-2;g<=2;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g}},
  _setupTypeNumber:function(){},_setupTypeInfo:function(){},};function QRBitBuffer(){this.buffer=[];this.length=0}
  QRBitBuffer.prototype={get:function(a){return 1==(this.buffer[a>>>3]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=this.buffer.length;this.buffer.length<=this.length>>>3&&this.buffer.push(0);a&&(this.buffer[this.length>>>3]|=128>>>this.length%8);this.length++}};
  qrcode.stringToBytes=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b.push(d):2048>d?b.push(192|d>>6,128|d&63):55296<=d&&57343>=d?(c++,d=65536+((d&1023)<<10|a.charCodeAt(c)&1023),b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|d&63)):b.push(224|d>>12,128|d>>6&63,128|d&63)}return b};qrcode.getRSBlocks=function(a,b){var c=[[],[7,19,0,0],[10,16,0,0],[15,13,0,0],[20,9,0,0],[26,8,0,0],[18,14,0,0],[20,14,0,0],[24,12,0,0],[30,10,0,0],[18,16,0,0]];return[{dataCount:c[a][1]}]};
  window.QREasy=function(el,width,height,text){return new m(el,{width:width||480,height:height||480,typeNumber:10,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRErrorCorrectLevel.M,text:text})};
  })();
  // End tiny QR generator
  </script>

  <script>
    const elBox = document.getElementById('qrcodeBox');
    const genBtn = document.getElementById('genBtn');
    const dlBtn = document.getElementById('downloadBtn');
    const clearBtn = document.getElementById('clearBtn');
    const yr = document.getElementById('yr');
    yr.textContent = new Date().getFullYear();

    let qrInstance = null;

    function sanitizeFilename(s) {
      return s.replace(/[^a-z0-9\-\_\(\)\[\]\s,\.]/gi,'').trim().replace(/\s+/g,' ');
    }

    function buildSMSURI(phone, body) {
      // iOS supports: sms:+1XXXYYYZZZZ&body=...
      const p = phone && phone.trim() ? phone.trim() : '';
      const urlBody = encodeURIComponent(body);
      return `sms:${encodeURIComponent(p)}&body=${urlBody}`;
    }

    function makeBody(prefix, address, pickup, extra) {
      const lines = [];
      if (prefix && prefix.trim()) lines.push(prefix.trim());
      if (address && address.trim()) lines.push(`My address is: ${address.trim()}`);
      if (pickup && pickup.trim()) lines.push(`My garbage pick up day is ${pickup.trim()}.`);
      if (extra && extra.trim()) lines.push(extra.trim());
      lines.push('Please confirm you’re available and send me a link for payment.');
      return lines.join(' ');
    }

    function generateQR(e) {
      e && e.preventDefault();
      const address = document.getElementById('address').value;
      const day = document.getElementById('pickup').value;
      const phone = document.getElementById('phone').value;
      const extra = document.getElementById('extra').value;
      const prefix = document.getElementById('prefix').value;

      if (!address || !day) {
        alert('Address and pickup day are required.');
        return;
      }
      const body = makeBody(prefix, address, day, extra);
      const smsURI = buildSMSURI(phone, body);

      qrInstance = window.QREasy(elBox, 520, 520, smsURI);
      dlBtn.disabled = false;
    }

    function downloadPNG() {
      if (!qrInstance) return;
      const address = document.getElementById('address').value || 'qr';
      const filename = sanitizeFilename(address || 'qr') + '.png';
      qrInstance.downloadPNG(filename);
    }

    function clearAll() {
      document.getElementById('qrForm').reset();
      elBox.innerHTML = '<div class="caption">Your QR will appear here.</div>';
      dlBtn.disabled = true;
      qrInstance = null;
    }

    document.getElementById('qrForm').addEventListener('submit', generateQR);
    dlBtn.addEventListener('click', downloadPNG);
    clearBtn.addEventListener('click', clearAll);
  </script>
</body>
</html>
